<template>
    <template lwc:if={isRenderedChatBox}>
        <c-lms-admin-chat-box chat-group-id={chatboxParentId} chat-group-name={chatGroupName} ontogglebacktogroup={toggleBackToGroup}></c-lms-admin-chat-box>
    </template>
    <template lwc:else>
        <div class="chatter-group">

            <header class="header">
                <h1>Chatter Group</h1>
                <div class="search-bar">
                    <!-- Input with Search Icon -->
                    <div class="search-input-container">
                        <span class="search-icon">
                        <svg fill="#0000FF" stroke="#0000FF" stroke-width="2" width="18" height="18" 
                            viewBox="0 0 64 64" version="1.1" xml:space="preserve" class="search-icon">
                            <path d="M27 4C14.85 4 5 13.85 5 26s9.85 22 22 22c5.42 0 10.37-1.89 14.3-5.03l14.37 14.37c0.39 0.39 0.9 0.58 1.41 0.58s1.02-0.19 1.41-0.58c0.78-0.78 0.78-2.05 0-2.83L43.3 40.14C47.11 36.23 49 31.22 49 26 49 13.85 39.15 4 27 4zM27 44c-9.94 0-18-8.06-18-18s8.06-18 18-18 18 8.06 18 18-8.06 18-18 18z" />
                        </svg>
                    </span>
                        <input type="text" placeholder="Search Group" class="search-input" onkeyup={handleSearch} />
                        <span class="crose-icon" onclick={clearSearchBox}>
                        <svg width="10" height="10" fill="#0000FF" stroke="#0000FF" stroke-width="2" viewBox="0 0 28 28" >
                            <path d="M2.32129 2.32363C2.72582 1.9191 3.38168 1.9191 3.78621 2.32363L25.6966 24.234C26.1011 24.6385 26.1011 25.2944 25.6966 25.6989C25.2921 26.1035 24.6362 26.1035 24.2317 25.6989L2.32129 3.78854C1.91676 3.38402 1.91676 2.72815 2.32129 2.32363Z" fill="black"></path>
                            <path d="M25.6787 2.30339C25.2742 1.89887 24.6183 1.89887 24.2138 2.30339L2.30339 24.2138C1.89887 24.6183 1.89887 25.2742 2.30339 25.6787C2.70792 26.0832 3.36379 26.0832 3.76831 25.6787L25.6787 3.76831C26.0832 3.36379 26.0832 2.70792 25.6787 2.30339Z" fill="black"></path>
                        </svg>
                    </span>
                    </div>

                    <!-- Select with Search Icon -->
                    <!--<div class="search-input-container">
                     <span class="search-icon">
                         <svg fill="#0000FF" stroke="#0000FF" stroke-width="2" width="18" height="18" 
                            viewBox="0 0 64 64" version="1.1" xml:space="preserve" class="search-icon">
                            <path d="M27 4C14.85 4 5 13.85 5 26s9.85 22 22 22c5.42 0 10.37-1.89 14.3-5.03l14.37 14.37c0.39 0.39 0.9 0.58 1.41 0.58s1.02-0.19 1.41-0.58c0.78-0.78 0.78-2.05 0-2.83L43.3 40.14C47.11 36.23 49 31.22 49 26 49 13.85 39.15 4 27 4zM27 44c-9.94 0-18-8.06-18-18s8.06-18 18-18 18 8.06 18 18-8.06 18-18 18z" />
                        </svg>
                    </span>
                    <select class="filter-select" onchange={filterCourses}>
                        <option value=""  selected disabled hidden>Search Group Type</option>
                        <option value="" >All Group</option>
                        <option value="Active">Active Group</option>
                        <option value="Deactive">Deactive Group</option>
                    </select> 
                </div>-->
                </div>
                <div></div>
            </header>
            <div class="slds-grid slds-wrap slds-grid_align-center" lwc:ref="customGridElement">
                <template for:each={filteredGroups} for:item="group">
                    <div key={group.id} class="slds-col custom-width">
                        <div class="group-card">
                            <span class="group-details-info" onclick={toggleModelPopup} data-id ={group.Id}>
                            <svg width="20px" height="20px" viewBox="0 0 1024 1024" class="icon" >
                                <path fill="#000000" d="M512 64a448 448 0 110 896.064A448 448 0 01512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 01-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 017.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"></path>
                            </svg>
                            <span class="tooltip-text">Group Details</span>
                            </span>
                            <div class="group-header">
                                <img src={group.iconUrl} alt="Group Icon" class="group-icon" />
                                <!-- <img src={} alt="Group Icon" class="group-icon" /> -->
                            </div>

                            <!-- Card Content -->
                            <h4 class="group-title">{group.Name}</h4>
                            <div class="group-info">
                                <div class="group-owner">
                                    <svg fill="#000000" width="25px" height="25px" viewBox="0 0 256 256" id="Flat"
                                        class="custom-icon">
                                        <path
                                            d="M128,76a44,44,0,1,1-44,44A44,44,0,0,1,128,76Zm103.17676-2a7.99671,7.99671,0,0,1-10.92822,2.92822l-4.66822-2.69531A24.0036,24.0036,0,0,1,208,78.624V84a8,8,0,0,1-16,0V78.624a24.0036,24.0036,0,0,1-7.58032-4.39111l-4.66822,2.69531a8,8,0,0,1-8-13.85644l4.65687-2.68872a23.72829,23.72829,0,0,1,0-8.76612l-4.65687-2.68872a8,8,0,0,1,8-13.85644l4.66822,2.69531A24.0036,24.0036,0,0,1,192,33.376V28a8,8,0,0,1,16,0v5.376a24.0036,24.0036,0,0,1,7.58032,4.39111l4.66822-2.69531a8,8,0,1,1,8,13.85644l-4.65687,2.68872a23.72829,23.72829,0,0,1,0,8.76612l4.65687,2.68872A8.00037,8.00037,0,0,1,231.17676,74ZM200,64a8,8,0,1,0-8-8A8.00917,8.00917,0,0,0,200,64Zm22.37012,44.5564a7.99991,7.99991,0,0,0-6.99512,8.89209A89.40475,89.40475,0,0,1,216,128a87.63852,87.63852,0,0,1-22.24194,58.41064,79.70677,79.70677,0,0,0-24.431-22.97485,59.83657,59.83657,0,0,1-82.65418-.00024A79.7048,79.7048,0,0,0,62.2417,186.41016,87.9498,87.9498,0,0,1,128,40c2.72656,0,5.477.126,8.1748.37427a8.00012,8.00012,0,0,0,1.4668-15.93286C134.4585,24.14844,131.21436,24,128,24A103.95123,103.95123,0,0,0,57.81982,204.68091a7.93384,7.93384,0,0,0,1.32544,1.18921,103.78418,103.78418,0,0,0,137.71155-.002,7.935,7.935,0,0,0,1.31983-1.18383A103.74663,103.74663,0,0,0,232,128a105.40092,105.40092,0,0,0-.73828-12.44849A8,8,0,0,0,222.37012,108.5564Z" />

                                    </svg>
                                    <strong>{group.groupAdminName}</strong>
                                </div>
                                <!-- <p class="group-members">
                                <svg fill="#000000" height="23px" width="23px" version="1.1" id="Capa_1"
                                    viewBox="0 0 611.998 611.998" xml:space="preserve" class="custom-icon">
                                    <path
                                        d="M382.167,150.945c9.702,10.875,16.557,24.306,20.381,39.921c3.629,14.822,4.44,31.308,2.414,49.006 c-0.751,6.546-1.861,13.96-3.479,21.802c12.532,12.135,28.95,19.839,50.296,19.838c59.22-0.005,80.529-59.3,86.105-108.006 c6.872-60.004-21.498-105.163-86.105-105.163c-50.698,0-79.079,27.82-85.628,68.798 C372.076,141.062,377.449,145.655,382.167,150.945z" />
                                    <path
                                        d="M611.973,422.704c-0.645-18.899-2.861-37.887-6.161-56.495c-3.992-22.539-9.08-55.585-28.759-70.275 c-11.38-8.491-26.117-11.278-39.143-16.398c-6.343-2.492-12.024-4.967-17.354-7.784c-17.995,19.734-41.459,30.055-68.782,30.057 c-21.261,0-40.172-6.281-56.001-18.358c-3.644,11.272-8.522,22.623-15.044,32.994c5.728,3.449,11.923,6.204,19.451,9.162 c3.332,1.31,6.99,2.506,10.864,3.771c10.472,3.422,22.339,7.301,32.994,15.255c25.329,18.907,31.564,54.336,36.117,80.207 l0.49,2.792c2.355,13.266,4.084,26.299,5.197,38.961c20.215-2.071,40.327-5.61,60.047-9.774 c15.941-3.365,31.774-7.471,47.109-13.003C605.247,439.397,612.476,437.343,611.973,422.704z" />
                                    <path
                                        d="M160.216,281.511c21.345,0.002,37.762-7.703,50.295-19.838c-1.618-7.841-2.728-15.256-3.479-21.802 c-2.026-17.697-1.214-34.184,2.414-49.006c3.823-15.614,10.679-29.046,20.381-39.921c4.718-5.291,10.09-9.884,16.014-13.805 c-6.549-40.978-34.93-68.798-85.628-68.798c-64.606,0-92.977,45.16-86.106,105.163 C79.687,222.212,100.996,281.507,160.216,281.511z" />
                                    <path
                                        d="M167.957,344.634c10.655-7.954,22.524-11.833,32.994-15.255c3.875-1.265,7.531-2.461,10.864-3.771 c7.528-2.957,13.725-5.711,19.451-9.162c-6.52-10.369-11.4-21.722-15.043-32.994c-15.829,12.077-34.741,18.358-56.001,18.358 c-27.322-0.001-50.788-10.324-68.782-30.057c-5.329,2.817-11.012,5.291-17.354,7.784c-13.026,5.12-27.763,7.907-39.143,16.398 c-19.678,14.691-24.767,47.735-28.759,70.275c-3.3,18.607-5.516,37.595-6.161,56.495c-0.502,14.64,6.726,16.693,18.974,21.112 c15.334,5.531,31.17,9.637,47.109,13.003c19.72,4.165,39.833,7.704,60.047,9.774c1.112-12.662,2.841-25.693,5.197-38.961 l0.49-2.792C136.394,398.971,142.628,363.541,167.957,344.634z" />
                                    <path
                                        d="M470.351,429.405l-0.493-2.805c-4.258-24.197-10.091-57.334-32.191-73.832c-9.321-6.957-19.872-10.404-30.078-13.74 c-4.019-1.313-7.812-2.554-11.427-3.974c-5.269-2.07-10.016-4.097-14.464-6.338c-18.684,24.932-44.58,38.059-75.383,38.062 c-30.795,0-56.687-13.128-75.371-38.062c-4.449,2.243-9.196,4.269-14.467,6.34c-3.61,1.418-7.406,2.659-11.424,3.972 c-10.207,3.335-20.761,6.784-30.079,13.74c-22.107,16.5-27.936,49.645-32.193,73.846l-0.493,2.795 c-3.557,20.086-5.68,39.572-6.308,57.914c-0.737,21.519,12.62,26.316,24.403,30.55l1.269,0.457 c14.17,5.112,30.021,9.492,48.457,13.388c37.646,7.946,68.197,11.74,96.138,11.938h0.072h0.072 c27.946-0.199,58.495-3.992,96.135-11.938c18.439-3.894,34.289-8.274,48.453-13.387l1.268-0.456 c11.786-4.233,25.147-9.029,24.41-30.553C476.03,468.931,473.906,449.447,470.351,429.405z" />
                                    <path
                                        d="M221.005,243.009c5.577,48.709,26.883,108.009,86.103,108.006s80.529-59.297,86.106-108.006 c6.871-60.002-21.503-105.16-86.106-105.16C242.515,137.847,214.123,183.002,221.005,243.009z" />

                                </svg>
                                {group.MemberCount} members
                            </p> -->
                                <p class="group-date">
                                    <svg fill="#000000" width="22px" height="22px" viewBox="0 0 64 64" id="Layer_1_1_"
                                        version="1.1" xml:space="preserve" class="custom-icon">
                                        <g>
                                            <path
                                                d="M46,22h-6.671l5.557-6.352C45.604,14.828,46,13.775,46,12.685V12.5c0-2.481-2.019-4.5-4.5-4.5S37,10.019,37,12.5V14h2v-1.5   c0-1.379,1.121-2.5,2.5-2.5s2.5,1.121,2.5,2.5v0.185c0,0.606-0.22,1.19-0.619,1.646L37,21.624V24h9V22z">
                                            </path>
                                            <path
                                                d="M54,24h2v-3h2v-2h-2V8h-2.618L48,18.764V21h6V24z M50.118,19L54,11.236V19H50.118z">
                                            </path>
                                            <path
                                                d="M50.405,32.627C57.596,31.061,63,24.653,63,17c0-8.822-7.178-16-16-16c-7.653,0-14.061,5.404-15.627,12.595   C29.608,13.207,27.807,13,26,13C12.215,13,1,24.215,1,38s11.215,25,25,25s25-11.215,25-25C51,36.193,50.793,34.392,50.405,32.627z    M47,3c7.72,0,14,6.28,14,14s-6.28,14-14,14s-14-6.28-14-14S39.28,3,47,3z M44.961,37H43v2h1.949   c-0.235,4.484-2.024,8.553-4.847,11.688l-1.375-1.375l-1.414,1.414l1.375,1.375c-3.135,2.824-7.204,4.612-11.688,4.847V55h-2v1.949   c-4.484-0.235-8.553-2.024-11.688-4.847l1.375-1.375l-1.414-1.414l-1.375,1.375C9.074,47.553,7.286,43.484,7.051,39H9v-2H7.051   c0.235-4.484,2.024-8.553,4.847-11.688l1.375,1.375l1.414-1.414l-1.375-1.375c3.135-2.824,7.204-4.612,11.688-4.847V21h2v-1.961   c1.438,0.076,2.862,0.318,4.255,0.72c1.156,6.611,6.374,11.829,12.986,12.986C44.642,34.138,44.884,35.562,44.961,37z M26,61   C13.317,61,3,50.683,3,38s10.317-23,23-23c1.706,0,3.407,0.201,5.072,0.577C31.03,16.047,31,16.52,31,17   c0,0.209,0.023,0.413,0.031,0.621C29.381,17.212,27.695,17,26,17C14.421,17,5,26.421,5,38s9.421,21,21,21s21-9.421,21-21   c0-1.695-0.212-3.381-0.621-5.031C46.587,32.977,46.791,33,47,33c0.48,0,0.953-0.03,1.423-0.072C48.799,34.593,49,36.294,49,38   C49,50.683,38.683,61,26,61z">
                                            </path>
                                            <path
                                                d="M29,38c0-1.302-0.839-2.402-2-2.816V23h-2v12.184c-1.161,0.414-2,1.514-2,2.816c0,1.654,1.346,3,3,3   c0.462,0,0.894-0.113,1.285-0.301l7.008,7.008l1.414-1.414l-7.008-7.008C28.887,38.894,29,38.462,29,38z M25,38   c0-0.552,0.448-1,1-1s1,0.448,1,1s-0.448,1-1,1S25,38.552,25,38z">
                                            </path>
                                            <path
                                                d="M56,35c-1.654,0-3,1.346-3,3c0,1.251,0.771,2.324,1.862,2.773c-0.627,6.584-3.499,12.781-8.152,17.527l1.428,1.4   c4.999-5.098,8.074-11.763,8.725-18.842C58.095,40.485,59,39.353,59,38C59,36.346,57.654,35,56,35z M56,39c-0.552,0-1-0.448-1-1   s0.448-1,1-1s1,0.448,1,1S56.552,39,56,39z">
                                            </path>
                                            <path
                                                d="M6.283,16.733c4.658-4.321,10.651-6.978,16.949-7.579C23.686,10.237,24.755,11,26,11c1.654,0,3-1.346,3-3s-1.346-3-3-3   c-1.352,0-2.485,0.905-2.858,2.137c-6.771,0.624-13.214,3.489-18.218,8.13L6.283,16.733z M26,7c0.552,0,1,0.448,1,1s-0.448,1-1,1   s-1-0.448-1-1S25.448,7,26,7z">
                                            </path>
                                        </g>
                                    </svg>
                                    {group.SystemModstamp}
                                </p>
                            </div>
                            <!-- See Group Button (Half Outside the Card) -->
                            <div class="group-footer">
                                <button class="slds-button slds-button_neutral see-group-button" data-id={group.Id}  data-name={group.Name}  onclick = {toggleChatBox}>Message</button>
                            </div>
                        </div>
                    </div>
                </template>


            </div>
        </div>
        <template lwc:if={isGrpDetailsReady}>
            <c-lms-chatter-group-details is-open={isOpen} ontogglepopup={toggleModelPopup}
                group-details={selectedGroupDetails}>
            </c-lms-chatter-group-details>
        </template>
    </template>

    <!-- <template lwc:if={isGrpChat}>
        <c-lms-q-a-chatter is-open={isGrpChat} ontogglechatbox={toggleChatBox} parent-id={chatboxParentId} chat-group-name={chatGroupName}>
        </c-lms-q-a-chatter>
    </template> -->
</template>